M365 品管系統開發手冊 (標準化範本版)
一、 系統架構定義 (System Architecture)
本系統採用「中樞與分支 (Hub-and-Spoke)」架構，將資料生產與現場應用完全解耦：
●	中樞管理中心 (SharePoint Hub)：存放所有專案基礎資料、工程目錄及查驗紀錄紀錄 2。
●	後台點位設定 APP (Office Admin)：辦公室端使用（16:9 佈局），負責管理平面圖並在圖上標定「固定座標點（L1b）」 3。
●	前台現場查驗 APP (Field Inspection)：現場端使用（手機版佈局），執行導航查驗、拍照及自動化驗收 4。
________________________________________
二、 資料中心規格 (SharePoint Schema)
為確保 APP 模組化通用，所有清單必須嚴格遵守以下格式 5：
1. 基礎與目錄清單 (全專案共用)
●	L0 - 平面圖庫：儲存底圖檔案（欄位：棟別、樓層、平面圖縮圖）。
●	L1 - 戶別樓層：定義專案實體結構（欄位：棟別、樓層、戶號 ID）。
●	L1b - 空間座標主檔：定義地圖上的「固定點位」，儲存 PointX、PointY 比例座標 6666。
●	L2 系列 - 工程目錄：
○	L2 (階段)：如 05 內裝工程、07 門窗工程。
○	L2a (工項)：如 07A 玄關門、08G 廚具工程。
○	L2b (缺失項目)：標準缺失描述與對應廠商。
2. 查驗紀錄清單 (L3 Template 標準化)
所有 L3 系列（如 L3a 木門）必須具備以下一致欄位以支援程式碼複製 7777：
●	座標欄位：PointX / PointY (數字，存儲 0.0 ~ 1.0 的比例值) 8888。
●	關聯欄位：樓層戶別 (Lookup L1)、點位關聯 (Lookup L1b)。
●	執行狀態：狀態 (選項：待改善/修繕完成)、缺失照片、改善照片 9。
________________________________________
三、 後台 APP 開發規格 (Office Admin)
●	佈局：16:9 電腦版寬螢幕。
●	核心技術：40x40 網格感應 (Grid Sensor) 10：
○	在圖片容器上疊加 40x40 透明網格 Gallery 11111111。
○	座標捕捉公式：
■	PointX = (Mod(格子編號-1, 40) + 0.5) / 40 12
■	PointY = (RoundDown((格子編號-1)/40) + 0.5) / 40 13
●	產出目標：於 L1b 清單建立具備精確 X/Y 比例座標的「錨點」。
________________________________________
四、 前台 APP 開發規格 (Field Inspection)
●	佈局：手機行動版介面。
●	四階段遞進導覽邏輯 14：
○	棟別選擇：過濾專案區域。
○	樓層選擇：進入查驗平面。
○	工項摘要 (Summary)：顯示該樓層各工項（如：木門、油漆）的待處理總數與完工率 (%) 15151515。
○	地圖落點 (Map View)：僅顯示 L1b 預設的固定點位 16。
●	地圖燈號邏輯 17：
○	灰燈 (半透明)：該點位尚無紀錄。
○	紅燈：已有「待改善」缺失。
○	綠燈：缺失已「修繕完成」。
●	智慧驗收：點擊紅燈點位 $\rightarrow$ 開啟表單彈窗 $\rightarrow$ 上傳改善照片 $\rightarrow$ 系統自動將狀態改為「修繕完成」 18181818。
________________________________________
五、 技術防呆與擴充規範 (Technical Standards)
●	座標防跑位機制 19：
1.	絕對禁止：存儲螢幕像素位置。
2.	強制執行：存儲 0.0 ~ 1.0 比例座標。計算方式為 位置 = 比例 * 容器當前寬度 20。
●	容器比例鎖定 21212121：
1.	地圖容器高度公式：Height = Width * (Image.OriginalHeight / Image.OriginalWidth)。
●	模組化複製流程 (Scaling Up) 22：
1.	依 L3 Template 複製新清單（如 L3b_油漆工程）。
2.	匯入 L2/L2a/L2b 工程目錄資料。
3.	複製範本 APP，全域取代資料來源名稱（L3a $\rightarrow$ L3b），其餘邏輯維持不變。
________________________________________
這份手冊確保了 M365 品管系統能以一致的技術標準，落實於多工地、多工程階段的數位化管理中。

